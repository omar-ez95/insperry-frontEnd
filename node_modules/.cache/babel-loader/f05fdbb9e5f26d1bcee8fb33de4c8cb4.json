{"ast":null,"code":"import _slicedToArray from\"/home/omar/Documents/inspery-FrontEnd/inspery/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link}from\"react-router-dom\";import PropTypes from\"prop-types\";import React,{useState,useEffect,useContext}from\"react\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{Context}from\"../../contexts/UserContext\";function Register(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password2=_useState8[0],setPassword2=_useState8[1];var navigate=useNavigate();var _useContext=useContext(Context),setUser=_useContext.setUser,isAuthenticated=_useContext.isAuthenticated,setIsAuthenticated=_useContext.setIsAuthenticated,setToken=_useContext.setToken;// if the user in logged in he will be redirected to the main page\nuseEffect(function(){if(isAuthenticated){navigate(\"/\");}},[isAuthenticated,navigate]);var registeration=function registeration(_ref){var username=_ref.username,password=_ref.password,email=_ref.email;var formData=new FormData();formData.append(\"username\",username);formData.append(\"password\",password);formData.append(\"email\",email);axios.defaults.xsrfCookieName='csrftoken';axios.defaults.xsrfHeaderName='X-CSRFToken';axios.post('http://18.192.205.152/api/auth/register',formData,{headers:{'Content-Type':'application/json'}}).then(function(res){setIsAuthenticated(true);setToken(res.data.token);setUser(res.data.user);var userData=res.data;localStorage.setItem('userData',JSON.stringify(userData));props.history.push(\"/\");}).catch(function(err){});};Register.propTypes={isAuthenticated:PropTypes.bool};var onSubmit=function onSubmit(e){e.preventDefault();if(password!==password2){// props.createMessage({ passwordNotMatch: 'Passwords do not match' });\n}else{var newUser={username:username,password:password,email:email};registeration(newUser);}};var regeisterForm=/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6 m-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card card-body mt-5\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"text-center\"},\"Register\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:onSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"userName\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"form-control\",name:\"userName\",onChange:function onChange(e){return setUsername(e.target.value);},value:username})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Email\"),/*#__PURE__*/React.createElement(\"input\",{type:\"email\",className:\"form-control\",name:\"email\",onChange:function onChange(e){return setEmail(e.target.value);},value:email})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Password\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control\",name:\"password\",onChange:function onChange(e){return setPassword(e.target.value);},value:password})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Confirm Password\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control\",name:\"password2\",onChange:function onChange(e){return setPassword2(e.target.value);},value:password2})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary\"},\"Register\")),/*#__PURE__*/React.createElement(\"p\",null,\"Already have an account? \",/*#__PURE__*/React.createElement(Link,{to:\"/login\"},\"Login\")))));return regeisterForm;}export default Register;","map":{"version":3,"sources":["/home/omar/Documents/inspery-FrontEnd/inspery/src/components/accounts/Register.js"],"names":["Link","PropTypes","React","useState","useEffect","useContext","axios","useNavigate","Context","Register","props","username","setUsername","email","setEmail","password","setPassword","password2","setPassword2","navigate","setUser","isAuthenticated","setIsAuthenticated","setToken","registeration","formData","FormData","append","defaults","xsrfCookieName","xsrfHeaderName","post","headers","then","res","data","token","user","userData","localStorage","setItem","JSON","stringify","history","push","catch","err","propTypes","bool","onSubmit","e","preventDefault","newUser","regeisterForm","target","value"],"mappings":"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","sourcesContent":["import { Link } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport axios from \"axios\";\nimport { useNavigate} from \"react-router-dom\"\n\nimport {Context} from \"../../contexts/UserContext\"\n\n\nfunction Register(props) {\n  const [username, setUsername] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [password2, setPassword2] = useState(\"\");\n  \n  const navigate = useNavigate()\n  const {setUser, isAuthenticated, setIsAuthenticated, setToken} = useContext(Context)\n  \n  // if the user in logged in he will be redirected to the main page\n  useEffect(() => {\n    if(isAuthenticated){\n      navigate(\"/\");\n     }\n  }, [isAuthenticated,navigate])\n\n  const registeration = ({ username, password, email }) => {\n    var formData = new FormData();\n    formData.append(\"username\", username); \n    formData.append(\"password\", password); \n    formData.append(\"email\", email); \n    axios.defaults.xsrfCookieName = 'csrftoken'\n    axios.defaults.xsrfHeaderName = 'X-CSRFToken'\n    axios\n      .post('http://18.192.205.152/api/auth/register', formData, {\n        headers: {\n          'Content-Type': 'application/json',\n        }\n    })\n      .then((res) => {\n        setIsAuthenticated(true)\n        setToken(res.data.token)\n        setUser(res.data.user)\n        const userData = res.data\n          localStorage.setItem('userData', JSON.stringify(userData))\n        props.history.push(\"/\");\n      })\n      .catch((err) => {\n\n      });\n  };\n\n  Register.propTypes = {\n    isAuthenticated: PropTypes.bool,\n  };\n\n  const onSubmit = (e) => {\n    e.preventDefault();\n    if (password !== password2) {\n      // props.createMessage({ passwordNotMatch: 'Passwords do not match' });\n    } else {\n      const newUser = {\n        username,\n        password,\n        email,\n      };\n      registeration(newUser);\n    }\n  };\n\n  const regeisterForm = (\n    <div className=\"col-md-6 m-auto\">\n      <div className=\"card card-body mt-5\">\n        <h2 className=\"text-center\">Register</h2>\n        <form onSubmit={onSubmit}>\n          <div className=\"form-group\">\n            <label>userName</label>\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              name=\"userName\"\n              onChange={(e) => setUsername(e.target.value)}\n              value={username}\n            />\n          </div>\n          <div className=\"form-group\">\n            <label>Email</label>\n            <input\n              type=\"email\"\n              className=\"form-control\"\n              name=\"email\"\n              onChange={(e) => setEmail(e.target.value)}\n              value={email}\n            />\n          </div>\n          <div className=\"form-group\">\n            <label>Password</label>\n            <input\n              type=\"password\"\n              className=\"form-control\"\n              name=\"password\"\n              onChange={(e) => setPassword(e.target.value)}\n              value={password}\n            />\n          </div>\n          <div className=\"form-group\">\n            <label>Confirm Password</label>\n            <input\n              type=\"password\"\n              className=\"form-control\"\n              name=\"password2\"\n              onChange={(e) => setPassword2(e.target.value)}\n              value={password2}\n            />\n          </div>\n          <div className=\"form-group\">\n            <button type=\"submit\" className=\"btn btn-primary\">\n              Register\n            </button>\n          </div>\n          <p>\n            Already have an account? <Link to=\"/login\">Login</Link>\n          </p>\n        </form>\n      </div>\n    </div>\n  )\n  \n    \n\n  return (\n      regeisterForm \n  );\n}\n\nexport default Register;\n"]},"metadata":{},"sourceType":"module"}