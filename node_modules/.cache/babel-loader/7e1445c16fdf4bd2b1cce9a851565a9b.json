{"ast":null,"code":"import _slicedToArray from\"/home/omar/Documents/inspery-FrontEnd/inspery/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useContext,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import{Context}from'../../contexts/UserContext';import ProfilePhoto from\"../profile/ProfilePhoto\";function ProductComments(_ref){var id=_ref.id,restaurant=_ref.restaurant;var _useContext=useContext(Context),user=_useContext.user,isAuthenticated=_useContext.isAuthenticated;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),comments=_useState2[0],setComments=_useState2[1];var _useState3=useState(parseInt(user.id)),_useState4=_slicedToArray(_useState3,1),owner=_useState4[0];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),body=_useState6[0],setBody=_useState6[1];var _useState7=useState(new Date()),_useState8=_slicedToArray(_useState7,1),date=_useState8[0];var navigate=useNavigate();useEffect(function(){if(isAuthenticated===false){navigate(\"/login\");}var getProductComments=function getProductComments(){axios.get(\"http://18.192.205.152/api/product_comments/\".concat(id)).then(function(res){setComments(res.data);}).catch(function(err){return console.log(err);});};getProductComments();},[id,isAuthenticated,navigate]);var onSubmit=function onSubmit(e){e.preventDefault();var comment={date:date,owner:owner,restaurant:restaurant,body:body,id:id};addProductComments(comment);setBody('');};//axios\nvar addProductComments=function addProductComments(comment){var formData=new FormData();formData.append(\"body\",comment.body);formData.append(\"user\",owner);formData.append(\"product\",parseInt(id,10));formData.append(\"restaurant\",parseInt(restaurant,10));axios.defaults.xsrfCookieName='csrftoken';axios.defaults.xsrfHeaderName='X-CSRFToken';axios.post(\"http://18.192.205.152/api/product_comments/\".concat(id,\"/\"),formData).then(function(res){setComments(res.data);}).catch(function(err){return console.log(err);});};var commentsList=comments.map(function(comment){return/*#__PURE__*/React.createElement(\"div\",{className:\"comment-box\",key:comment.id},/*#__PURE__*/React.createElement(ProfilePhoto,{username:comment.user}),/*#__PURE__*/React.createElement(\"div\",{className:\"text-box\"},comment.body,/*#__PURE__*/React.createElement(\"p\",{className:\"black-color\"},\"- \",formatTime(comment.date))),/*#__PURE__*/React.createElement(\"ul\",null));});return/*#__PURE__*/React.createElement(\"div\",{className:\"content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"scroll\"},comments.length>0?commentsList:null),/*#__PURE__*/React.createElement(\"div\",{className:\"card card-body  setMarginBottom\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:onSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"textarea\",{className:\"form-control\",type:\"text\",name:\"body\",onChange:function onChange(e){return setBody(e.target.value);},value:body})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary\"},\"Comment\")))));}function formatTime(time){var prefix=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"\";var t=new Date(time).toLocaleDateString();return t;}export default ProductComments;","map":{"version":3,"sources":["/home/omar/Documents/inspery-FrontEnd/inspery/src/components/comments/ProductComments.js"],"names":["React","useEffect","useContext","useState","useNavigate","axios","Context","ProfilePhoto","ProductComments","id","restaurant","user","isAuthenticated","comments","setComments","parseInt","owner","body","setBody","Date","date","navigate","getProductComments","get","then","res","data","catch","err","console","log","onSubmit","e","preventDefault","comment","addProductComments","formData","FormData","append","defaults","xsrfCookieName","xsrfHeaderName","post","commentsList","map","formatTime","length","target","value","time","prefix","t","toLocaleDateString"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\"\nimport axios from \"axios\";\n\nimport {Context} from '../../contexts/UserContext'\nimport ProfilePhoto from \"../profile/ProfilePhoto\";\nfunction ProductComments({id,restaurant}){\n    const {user, isAuthenticated} = useContext(Context)\n    const [comments,setComments]= useState([])\n    const [owner]= useState(parseInt(user.id))\n    const [body,setBody]= useState('')\n    const [date]= useState(new Date())\n    const navigate = useNavigate();\n\n    useEffect(() => {\n      if (isAuthenticated === false) {\n        navigate(\"/login\");\n      }\n      const getProductComments = ()  => {\n        axios.get(`http://18.192.205.152/api/product_comments/${id}`)\n        .then(res => {\n\n           setComments(res.data)\n        }).catch(err => console.log(err));\n      }\n        getProductComments()\n    },[id,isAuthenticated,navigate])\n\n    const onSubmit = (e) => {\n        e.preventDefault();\n        const comment =  { date, owner,restaurant ,body, id};\n        addProductComments(comment);\n        setBody('')\n      };\n\n    //axios\n    const addProductComments = (comment )=>  {\n\n        var formData = new FormData();\n          formData.append(\"body\", comment.body); \n          formData.append(\"user\", owner);\n          formData.append(\"product\", parseInt(id , 10 ));\n          formData.append(\"restaurant\",parseInt(restaurant , 10 ) );\n          axios.defaults.xsrfCookieName = 'csrftoken'\n          axios.defaults.xsrfHeaderName = 'X-CSRFToken'\n          axios\n            .post(`http://18.192.205.152/api/product_comments/${id}/`,formData).then((res) => {\n             setComments(res.data)\n          })\n          .catch((err) => console.log(err));\n      };\n            \n  \n      \n\n        const commentsList = comments.map((comment) => (\n            <div className=\"comment-box\" key={comment.id}>\n              <ProfilePhoto username={comment.user} />\n              <div className=\"text-box\">\n                {comment.body}\n                <p className=\"black-color\">- {formatTime(comment.date)}</p>\n              </div>\n              <ul></ul>\n            </div>\n          ));\n\n    return(\n        <div className='content' >\n            <div className=\"scroll\">\n            {comments.length > 0 ?  commentsList : null}\n        \n        </div>\n            <div className=\"card card-body  setMarginBottom\">\n    <form onSubmit={onSubmit}>\n        <div className=\"form-group\">\n            <textarea\n            className=\"form-control\"\n            type=\"text\"\n            name=\"body\"\n            onChange={(e) => setBody(e.target.value)}\n            value={body}\n            />\n        </div>\n        <div className=\"form-group\">\n            <button type=\"submit\" className=\"btn btn-primary\">\n            Comment\n            </button>\n        </div>\n        </form>\n    </div>\n        </div>\n        )\n}\n\nfunction formatTime(time, prefix = \"\") {\n    const t = new Date(time).toLocaleDateString();\n    return t;\n}\n\nexport default ProductComments"]},"metadata":{},"sourceType":"module"}